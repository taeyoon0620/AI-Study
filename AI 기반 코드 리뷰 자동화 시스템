ê¸°ëŠ¥ ìš”ì•½
âœ… GitHubì—ì„œ ìƒˆë¡œìš´ PR(í’€ ë¦¬í€˜ìŠ¤íŠ¸)ì„ ê°ì§€
âœ… ë³€ê²½ëœ ì½”ë“œì˜ ìŠ¤íƒ€ì¼ ê²€ì‚¬ (Pylint)
âœ… GPT-4ë¥¼ í™œìš©í•œ ì½”ë“œ ë¦¬ë·° ìƒì„±
âœ… PRì— ìë™ìœ¼ë¡œ ë¦¬ë·° ì½”ë©˜íŠ¸ ë‹¬ê¸°

ê¸°ìˆ  ìŠ¤íƒ
GitHub API â†’ PR ë³€ê²½ ì‚¬í•­ ê°€ì ¸ì˜¤ê¸° & ë¦¬ë·° ë“±ë¡
Pylint â†’ ì½”ë“œ ìŠ¤íƒ€ì¼ ê²€ì‚¬
OpenAI GPT-4 API â†’ ì½”ë“œ ë¦¬ë·° ìë™ ìƒì„±
Flask â†’ ì›¹í›… ì„œë²„ (GitHub ì´ë²¤íŠ¸ ê°ì§€)

1. í”„ë¡œì íŠ¸ ì„¤ì •
í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

pip install requests openai flask pylint

2. GitHub Webhook ì„¤ì •
GitHubì—ì„œ **"Pull Request ì´ë²¤íŠ¸"**ë¥¼ ê°ì§€í•˜ë„ë¡ Webhookì„ ì„¤ì •í•©ë‹ˆë‹¤.
GitHub Repository â†’ Settings â†’ Webhooks â†’ "Add Webhook"

Payload URL: http://<your-server-ip>:5000/webhook
Content type: application/json
ì´ë²¤íŠ¸: Pull Request

3. Flask ì›¹í›… ì„œë²„ êµ¬í˜„
GitHubì—ì„œ PR ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•˜ì—¬ ìë™ ë¦¬ë·°ë¥¼ ìƒì„±í•˜ëŠ” ì„œë²„ì…ë‹ˆë‹¤.

import os
import requests
import openai
import json
from flask import Flask, request

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
GITHUB_TOKEN = "ghp_XXXXXX"  # GitHub Personal Access Token
OPENAI_API_KEY = "sk-XXXXXX"  # OpenAI API Key
REPO_OWNER = "your-username"
REPO_NAME = "your-repo"

app = Flask(__name__)

# GitHub API ìš”ì²­ í—¤ë”
HEADERS = {
    "Authorization": f"token {GITHUB_TOKEN}",
    "Accept": "application/vnd.github.v3+json"
}

# GPT-4ë¥¼ í™œìš©í•œ ì½”ë“œ ë¦¬ë·° ìƒì„±
def generate_review_comment(code_diff):
    prompt = f"""
    ë‹¤ìŒì€ ì½”ë“œ ë³€ê²½ ì‚¬í•­ì…ë‹ˆë‹¤. ì½”ë“œ ë¦¬ë·°ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.

    ```diff
    {code_diff}
    ```

    ë¦¬ë·°ëŠ” ê°œì„ ì ê³¼ ì½”ë“œ ìŠ¤íƒ€ì¼ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.
    """
    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[{"role": "user", "content": prompt}]
    )
    return response["choices"][0]["message"]["content"]

# PR ë³€ê²½ ì‚¬í•­ ê°€ì ¸ì˜¤ê¸°
def get_pr_diff(pr_number):
    url = f"https://api.github.com/repos/{REPO_OWNER}/{REPO_NAME}/pulls/{pr_number}"
    response = requests.get(url, headers=HEADERS)
    if response.status_code == 200:
        return response.json().get("diff_url")
    return None

# PRì— ë¦¬ë·° ì½”ë©˜íŠ¸ ì¶”ê°€
def add_pr_comment(pr_number, comment):
    url = f"https://api.github.com/repos/{REPO_OWNER}/{REPO_NAME}/issues/{pr_number}/comments"
    data = {"body": comment}
    response = requests.post(url, headers=HEADERS, json=data)
    return response.status_code

# GitHub Webhook ì²˜ë¦¬
@app.route("/webhook", methods=["POST"])
def webhook():
    payload = request.get_json()
    
    if payload.get("action") == "opened":
        pr_number = payload["pull_request"]["number"]
        diff_url = get_pr_diff(pr_number)
        
        if diff_url:
            diff_content = requests.get(diff_url).text
            review_comment = generate_review_comment(diff_content)
            add_pr_comment(pr_number, review_comment)
            
    return "OK", 200

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
4. ì‹¤í–‰ ë°©ë²•
ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ì›¹í›… ì„œë²„ë¥¼ ë„ì›ë‹ˆë‹¤.

python app.py

GitHubì—ì„œ PRì„ ìƒì„±í•˜ë©´ ìë™ìœ¼ë¡œ ë¦¬ë·°ê°€ ìƒì„±ë©ë‹ˆë‹¤. ğŸ‰

ì¶”ê°€ ê°œì„  ê°€ëŠ¥ ê¸°ëŠ¥
pylintë¡œ ì½”ë“œ ìŠ¤íƒ€ì¼ ë¶„ì„ ì¶”ê°€
ë³´ì•ˆ ì·¨ì•½ì  ê²€ì‚¬ ê¸°ëŠ¥ (SQL Injection, XSS ë“±)
PR ìŠ¹ì¸/ê±°ë¶€ ìë™í™”
